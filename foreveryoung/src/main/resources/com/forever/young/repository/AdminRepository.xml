<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.forever.young.repository.AdminRepository">


	<!-- 관리자 로그인 -->
	<select id="login" resultType="Admin">
		select *from admin
		where admin_id =
		#{admin_id}
		and admin_pw = #{admin_pw}
	</select>

	<!-- 관리자 등록 -->
	<insert id="join">
		insert into admin
		values(admin_seq.nextval,
		#{admin_id}, #{admin_pw},
		#{admin_name},sysdate,#{admin_phone})
	</insert>

	<!-- 관리자 리스트 -->
	<select id="adminList" resultType="Admin">
  		<![CDATA[
  			select * from admin
  		]]>
	</select>
	
	<!-- 브랜드 리스트 -->
	<select id="brandList" resultType="Brand">
  		<![CDATA[
  			select * from brand
  		]]>
	</select>

	<!-- 고객 리스트 -->
	<select id="customerList" resultType="Customer">
  		<![CDATA[
  			select * from customer
  		]]>
	</select>
	
	<!-- 상품 리스트 -->
	<select id="productList" resultType="ProductVO">
  		  		<![CDATA[
  			select p.* , b.brand_name from product_table p
    			left outer join brand b on p.product_seller_num = b.brand_num
  		]]>
	</select>

	<!-- 이벤트 리스트 -->
	<select id="eventList" resultType="Event">
  		<![CDATA[
  			select * from event
  		]]>
	</select>

	<!-- 공지사항 리스트 -->
	<select id="noticeList" resultType="Notice">
  		<![CDATA[
  			select * from notice
  		]]>
	</select>

	<!-- 1:1문의 리스트 -->
	<select id="inquiryList" resultType="InquiryVO">
  		<![CDATA[
  			  	select I.* , C.user_id, R.reply_no from inquiry I
 				left outer join customer C on C.user_num = I.user_num
 				left outer join reply R on R.inquiry_no = I.inquiry_no
  		]]>
	</select>

	<!-- 이벤트  등록 -->
	<insert id="eventRegister">
		insert into event
		 values (event_seq.nextval, #{event_name}, #{event_start}, #{event_end}, 
		 #{event_discount}, #{event_target})
	</insert>

	<!-- 공지사항  등록 -->
	<insert id="noticeRegister">
		insert into notice values(notice_seq.nextval,
		 #{notice_type} , #{notice_title}, #{notice_content},  null)
	</insert>
	
	<!-- 총 고객수 -->
	<select id="customerCount" resultType="int">
		select count(*) from customer
	</select>
	
	<!-- 총 브랜드수 -->
	<select id="brandCount" resultType="int">
		select count(*) from brand
	</select>
	
	<!-- 총 상품수 -->
	<select id="productCount" resultType="int">
		select count(*) from product_table
	</select>	
	
	<!-- 공지사항 상세보기 -->	
	<select id="noticeDetail" resultType="Notice">
		select * from notice where notice_no = #{notice_no}
	</select>

	<!-- 1:1문의 상세보기 -->
	<select id="inquiryDetail" resultType="InquiryVO">
		 select I.* , R.reply_no , R.reply_content , C.user_id  from inquiry I
 			left outer join customer C on C.user_num = I.user_num
 			left outer join reply R on R.inquiry_no = I.inquiry_no 
 			where I.inquiry_no = #{inquiry_no}	

	</select>
	
	<!-- 공지사항 수정 -->
	<select id="noticeModify">
		update notice set
			 notice_type =#{notice_type} , 
			 notice_title=#{notice_title} , 
			 notice_content=#{notice_content}
		 where notice_no =#{notice_no}
	</select>
	
	<!-- 공지사항 삭제 -->
	<delete id="noticeDelete">
		delete from notice where notice_no = #{notice_no}
	</delete>
	
	<!-- 1:1문의 답변 등록 -->
	<insert id="replyRegister">
	 insert into reply 
	 	values(reply_seq.nextval, #{reply_content},sysdate, #{inquiry_no}, null)
	</insert>
	
	<!-- 1:1문의 상태 답변완료로 변경 -->
	<update id="inquiryStatusComplete">
		update inquiry set inquiry_status = '답변완료' where inquiry_no=#{inquiry_no}
	</update>
  
	<!-- 1:1문의 상태 답변대기로 수정 -->
	 
	<!-- 1:1문의 답변 수정 -->
	
	<!-- 1:1문의 답변 삭제 -->
	
	<!--관리자 상세보기 -->
	<select id="adminDetail" resultType="admin">
		select * from admin where admin_no =#{admin_no}
	</select>
	
	<!-- 관리자 정보 수정 -->
	<update id="adminModify">
		update admin set 
			admin_name=#{admin_name} ,
			admin_phone=#{admin_phone}
		 where admin_no=#{admin_no}  
	</update>
	
	<!-- 관리자 삭제 -->
	<delete id="adminDelete">
	delete from admin where admin_no =#{admin_no}
	</delete>

</mapper>
 


  
  
  
  
  
  
  
  
  
  
  
  