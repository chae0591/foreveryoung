<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.forever.young.repository.ServiceCenterRepository">

	<!-- 공지사항 리스트 -->
	<select id="noticeList" resultType="Notice">
  		<![CDATA[
  			select * from notice
  		]]>
	</select>

	<!-- 1:1문의 리스트 -->
	<select id="inquiryList" resultType="Inquiry">
  		<![CDATA[
  			  	select I.* , C.user_id from inquiry I
 				left outer join customer C on C.user_num = I.user_num
  		]]>
	</select>

	<!-- 1:1문의 상세보기 -->
	<select id="inquiryDetail" resultType="InquiryVO">
		 select I.* , R.reply_no , R.reply_content , C.user_id  from inquiry I
 			left outer join customer C on C.user_num = I.user_num
 			left outer join reply R on R.inquiry_no = I.inquiry_no 
 			where I.inquiry_no = #{inquiry_no}	

	</select>
	
	<!-- 1:1문의  등록 -->
	<insert id="inquiryRegister">
		insert into inquiry (inquiry_no, inquiry_title, inquiry_content, inquiry_regDate, user_num)
		values(inquiry_seq.nextval, #{inquiry_title}, #{inquiry_content}, sysdate, #{user_num})

	</insert>
	
	<!-- 1:1문의 수정 -->
	<select id="inquiryModify">
		update inquiry set
			 inquiry_title=#{inquiry_title} , 
			 inquiry_content=#{inquiry_content},
			 inquiry_regdate=sysdate,
		 where inquiry_no =#{inquiry_no}
	</select>
	
	<!-- 1:1문의 삭제 -->
	<delete id="inquiryDelete">
		delete from inquiry where inquiry_no = #{inquiry_no}
	</delete>
	 
	 <insert id="addAttach">
		insert into inquiry (user_num) 
		values (#{userNum})
	</insert>
	
    <select id="getUser_num" resultType="Integer">
		select customer_seq.currval from dual
	</select>
	
	<!-- <select id="getAttach" resultType="string">
		select inquiry_no from inquiry
		where user_num = #{user_num}
		order by inquiry_regdate
	</select> -->

</mapper>
 